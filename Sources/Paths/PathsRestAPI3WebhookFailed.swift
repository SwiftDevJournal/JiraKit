// Generated by Create API
// https://github.com/CreateAPI/CreateAPI

import Foundation
import Get
import URLQueryEncoder

extension Paths.API.__3.Webhook {
    public var failed: Failed {
        Failed(path: path + "/failed")
    }

    public struct Failed {
        /// Path: `/rest/api/3/webhook/failed`
        public let path: String

        /// Get failed webhooks
        ///
        /// Returns webhooks that have recently failed to be delivered to the requesting app after the maximum number of retries.
        /// 
        /// After 72 hours the failure may no longer be returned by this operation.
        /// 
        /// The oldest failure is returned first.
        /// 
        /// This method uses a cursor-based pagination. To request the next page use the failure time of the last webhook on the list as the `failedAfter` value or use the URL provided in `next`.
        /// 
        /// **[Permissions](#permissions) required:** Only [Connect apps](https://developer.atlassian.com/cloud/jira/platform/index/#connect-apps) can use this operation.
        public func get(maxResults: Int32? = nil, after: Int64? = nil) -> Request<JiraKit.FailedWebhooks> {
            Request(method: "GET", url: path, query: makeGetQuery(maxResults, after), id: "getFailedWebhooks")
        }

        private func makeGetQuery(_ maxResults: Int32?, _ after: Int64?) -> [(String, String?)] {
            let encoder = URLQueryEncoder()
            encoder.encode(maxResults, forKey: "maxResults")
            encoder.encode(after, forKey: "after")
            return encoder.items
        }
    }
}
